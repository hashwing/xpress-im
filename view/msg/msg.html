<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title></title>
		<link href="../../css/mui.min.css" rel="stylesheet" />
		<link href="../../css/app.css" rel="stylesheet"/>
	</head>
	<body>
		<div class="mui-content">
			<ul id="list" class="mui-table-view mui-table-view-chevron">
				<li class="mui-table-view-cell">
					<a class="mui-navigate-right" href="examples/accordion.html">
						accordion（折叠面板）
					</a>
				</li>
			</ul>
		</div>
		

		<script src="../../js/mui.min.js"></script>
		<script src="../../js/util.js"></script>
		<script src="../../js/app.js"></script>
		<script type="text/javascript" charset="utf-8">
			function loginSuccess() {
				initNav()
			}
			mui.init({
				keyEventBind: {
					backbutton: false //关闭back按键监听
				}
			});
			mui.plusReady(function() {
				//
				var user = plus.storage.getItem("user")
				var pwd = plus.storage.getItem("pwd")
				if (user == "" || user == null || pwd == "" || pwd == null) {
					mui.openWindow({
						url: "../login/login.html",
						id: "login",
					})
				} else {
					console.log(user + "," + pwd)
					initNav()
				}
			})

			function initNav() {
				indexPage = plus.webview.currentWebview()

				// 创建子webview窗口 并初始化
				var aniShow = {};
				util.initSubpage(aniShow);

				var nview = plus.nativeObj.View.getViewById('tabBar'),
					activePage = plus.webview.currentWebview(),
					targetPage,
					subpages = util.options.subpages,
					pageW = window.innerWidth,
					currIndex = 0;

				/**
				 * 根据判断view控件点击位置判断切换的tab
				 */
				nview.addEventListener('click', function(e) {
					var clientX = e.clientX;
					if (clientX > 0 && clientX <= parseInt(pageW * 0.33)) {
						currIndex = 0;

					} else if (clientX > parseInt(pageW * 0.33) && clientX <= parseInt(pageW * 0.66)) {
						currIndex = 1;
					} else {
						currIndex = 2;
					}
					// 匹配对应tab窗口	
					if (currIndex > 0) {
						targetPage = plus.webview.getWebviewById(subpages[currIndex - 1]);
					} else {
						targetPage = plus.webview.currentWebview();
					}

					if (targetPage == activePage) {
						return;
					}
					//底部选项卡切换
					util.toggleNview(currIndex);
					// 子页面切换
					util.changeSubpage(targetPage, activePage, aniShow);
					//更新当前活跃的页面
					activePage = targetPage;
					util.setTitle(indexPage,currIndex)
				});
			}
		</script>
	</body>
</html>
